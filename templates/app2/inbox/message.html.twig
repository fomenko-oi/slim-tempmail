{% extends 'layouts/frontend_v2.html.twig' %}

{% block content %}
    <main class="flex-lg-grow-1">
        <div class="chat chat-offcanvas open">
            <div class="d-flex">
                <div class="flex-grow-1">
                    <div class="container px-lg-5">
                        <div class="chat-header">
                            <span class="avatar avatar-sm mr-3 bg-info rounded-circle">{{ message.firstSenderLetter }}</span>
                            <div class="mr-auto">
                                <h3 class="mb-2 fs-xxs lh-sm">{{ message.sender }}</h3>
                                <p class="lh-sm">{{ message.subject }}</p>
                            </div>

                            <div class="d-flex align-items-center">
                                {# source #}
                                <a href="/{{ lang }}/message/{{ message.id }}/source" class="btn d-none d-xl-inline-block link-body" target="_blank" type="button">
                                    <i class="gi-animation-hover">
                                        <svg class="gi gi-video-fill gi-animation gi-animation-hover-pulse fs-lg" width="1em" height="1em" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M21 7.15a1.7 1.7 0 0 0-1.85.3l-2.15 2V8a3 3 0 0 0-3-3H5a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h9a3 3 0 0 0 3-3v-1.45l2.16 2a1.74 1.74 0 0 0 1.16.45 1.68 1.68 0 0 0 .69-.15 1.6 1.6 0 0 0 1-1.48V8.63A1.6 1.6 0 0 0 21 7.15z"/>
                                        </svg>
                                    </i>
                                </a>

                                {# delete #}
                                <a href="/message/{{ message.id }}" class="btn d-none d-xl-inline-block ml-5 link-body deleteMail" data-id="{{ message.id }}">
                                    <i class="gi-animation-hover">
                                        <svg class="gi gi-phone-call-fill gi-animation gi-animation-hover-pulse fs-lg" width="1em" height="1em" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M13 8a3 3 0 0 1 3 3 1 1 0 0 0 2 0 5 5 0 0 0-5-5 1 1 0 0 0 0 2z"/>
                                            <path d="M13 4a7 7 0 0 1 7 7 1 1 0 0 0 2 0 9 9 0 0 0-9-9 1 1 0 0 0 0 2z"/>
                                            <path d="M21.75 15.91a1 1 0 0 0-.72-.65l-6-1.37a1 1 0 0 0-.92.26c-.14.13-.15.14-.8 1.38a9.91 9.91 0 0 1-4.87-4.89C9.71 10 9.72 10 9.85 9.85a1 1 0 0 0 .26-.92L8.74 3a1 1 0 0 0-.65-.72 3.79 3.79 0 0 0-.72-.18A3.94 3.94 0 0 0 6.6 2 4.6 4.6 0 0 0 2 6.6 15.42 15.42 0 0 0 17.4 22a4.6 4.6 0 0 0 4.6-4.6 4.77 4.77 0 0 0-.06-.76 4.34 4.34 0 0 0-.19-.73z"/>
                                        </svg>
                                    </i>
                                </a>

                                <div class="dropdown d-xl-none ml-5">
                                    <button class="btn link-body" data-toggle="dropdown" type="button" aria-haspopup="true" aria-expanded="false">
                                        <i class="gi-animation-hover">
                                            <svg class="gi gi-settings-2-fill gi-animation gi-animation-hover-pulse fs-lg" width="1em" height="1em" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <circle cx="12" cy="12" r="1.5"/>
                                                <path d="M20.32 9.37h-1.09c-.14 0-.24-.11-.3-.26a.34.34 0 0 1 0-.37l.81-.74a1.63 1.63 0 0 0 .5-1.18 1.67 1.67 0 0 0-.5-1.19L18.4 4.26a1.67 1.67 0 0 0-2.37 0l-.77.74a.38.38 0 0 1-.41 0 .34.34 0 0 1-.22-.29V3.68A1.68 1.68 0 0 0 13 2h-1.94a1.69 1.69 0 0 0-1.69 1.68v1.09c0 .14-.11.24-.26.3a.34.34 0 0 1-.37 0L8 4.26a1.72 1.72 0 0 0-1.19-.5 1.65 1.65 0 0 0-1.18.5L4.26 5.6a1.67 1.67 0 0 0 0 2.4l.74.74a.38.38 0 0 1 0 .41.34.34 0 0 1-.29.22H3.68A1.68 1.68 0 0 0 2 11.05v1.89a1.69 1.69 0 0 0 1.68 1.69h1.09c.14 0 .24.11.3.26a.34.34 0 0 1 0 .37l-.81.74a1.72 1.72 0 0 0-.5 1.19 1.66 1.66 0 0 0 .5 1.19l1.34 1.36a1.67 1.67 0 0 0 2.37 0l.77-.74a.38.38 0 0 1 .41 0 .34.34 0 0 1 .22.29v1.09A1.68 1.68 0 0 0 11.05 22h1.89a1.69 1.69 0 0 0 1.69-1.68v-1.09c0-.14.11-.24.26-.3a.34.34 0 0 1 .37 0l.76.77a1.72 1.72 0 0 0 1.19.5 1.65 1.65 0 0 0 1.18-.5l1.34-1.34a1.67 1.67 0 0 0 0-2.37l-.73-.73a.34.34 0 0 1 0-.37.34.34 0 0 1 .29-.22h1.09A1.68 1.68 0 0 0 22 13v-1.94a1.69 1.69 0 0 0-1.68-1.69zM12 15.5a3.5 3.5 0 1 1 3.5-3.5 3.5 3.5 0 0 1-3.5 3.5z"/>
                                            </svg>
                                        </i>
                                        <span class="sr-only">Toggle Dropdown</span>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-right">
                                        <a href="/message/{{ message.id }}" class="dropdown-item deleteMail" data-id="{{ message.id }}">{{ 'delete'|trans }}</a>

                                        <a href="/{{ lang }}/message/{{ message.id }}/source" class="dropdown-item" data-id="{{ message.id }}">{{ 'source'|trans }}</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="chat-body" style="overflow-x: hidden; overflow-y: hidden; height: 100%">
                            <div class="py-5">
                                <div class="d-flex align-items-end mb-5">
                                    {{ message.body|raw }}
                                </div>

                                {% if message.files %}
                                    <div class="d-flex align-items-lg-end" style="border: 1px dashed silver">
                                        <div class="card-body d-flex flex-row" style="color: black; opacity: 0.6">{{ 'attachments'|trans }}:</div>

                                        {% for attachment in message.files %}
                                            <div class="card-body d-flex align-items-center">
                                            <span class="icon bg-neutral border rounded-circle">
                                                <svg class="gi gi-file-text-fill fs-xs" width="1em" height="1em" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M19.74 7.33l-4.44-5a1 1 0 0 0-.74-.33h-8A2.53 2.53 0 0 0 4 4.5v15A2.53 2.53 0 0 0 6.56 22h10.88A2.53 2.53 0 0 0 20 19.5V8a1 1 0 0 0-.26-.67zM9 12h3a1 1 0 0 1 0 2H9a1 1 0 0 1 0-2zm6 6H9a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2zm-.29-10a.79.79 0 0 1-.71-.85V4l3.74 4z"></path>
                                                </svg>
                                            </span>
                                                <div class="mr-4 ml-n3"></div>
                                                <div class="mr-auto">
                                                    <h3 class="mb-2 fs-xxs lh-sm">
                                                        <a href="/{{ lang }}/message/{{ message.id }}/attachment/{{ attachment.id }}">{{ attachment.name }}</a>
                                                    </h3>

                                                    {% if(attachment.size) %}
                                                        <p class="lh-sm">{{ attachment.size }}kb</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
{% endblock %}
